---
layout: default
---

<!-- 滚动到顶部和底部按钮 -->
<style>
#scroll-buttons {
  position: fixed;
  right: 24px;
  bottom: 40px;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 999;
  transition: opacity 0.4s;
  opacity: 0;
  pointer-events: none;
}
#scroll-buttons.show {
  opacity: 1;
  pointer-events: auto;
}
#scroll-buttons button {
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 50%;
  padding: 0;
  margin: 4px 0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  cursor: pointer;
  transition: background 0.2s;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}
#scroll-buttons button:hover {
  background: #f0f0f0;
}
#scroll-buttons img {
  width: 44px;
  height: 44px;
  object-fit: contain;
  pointer-events: none;
}
</style>
<div id="scroll-buttons">
  <button id="scroll-to-top" title="回到顶部">
    <img src="/img/post_up.svg" alt="Up">
  </button>
  <button id="scroll-to-bottom" title="跳到页尾">
    <img src="/img/post_down.svg" alt="Down">
  </button>
</div>
<script>
(function() {
  const scrollButtons = document.getElementById('scroll-buttons');
  const btnUp = document.getElementById('scroll-to-top');
  const btnDown = document.getElementById('scroll-to-bottom');

  function toggleButtons() {
    const scrollY = window.scrollY || window.pageYOffset;
    const windowHeight = window.innerHeight;
    const docHeight = document.documentElement.scrollHeight;
    if (scrollY > 100 && (docHeight - (scrollY + windowHeight) > 100)) {
      scrollButtons.classList.add('show');
    } else {
      scrollButtons.classList.remove('show');
    }
  }
  window.addEventListener('scroll', toggleButtons);

  btnUp.addEventListener('click', function() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
  btnDown.addEventListener('click', function() {
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  });
})();
</script>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<!-- Post Header -->
<style type="text/css">
    header.intro-header {
        position: relative;
        background-image: url('{{ site.baseurl }}/{% if page.header-img %}{{ page.header-img }}{% else %}{{ site.header-img }}{% endif %}');
    }
    {% if page.header-mask %}
    header.intro-header .header-mask {
        width: 100%;
        height: 100%;
        position: absolute;
        background: rgba(0,0,0, {{ page.header-mask }});
    }
    {% endif %}
</style>
<header class="intro-header">
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>{{ page.title }}</h1>
                    <h2 class="subheading">{{ page.subtitle }}</h2>
                    <span class="meta">Posted by {% if page.author %}{{ page.author }}{% else %}{{ site.title }}{% endif %} on {{ page.date | date: "%B %-d, %Y" }}</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- 弹出层 -->
<div class="image-modal" id="imageModal">
    <img id="modalImage" src="" alt="Enlarged Image">
</div>

<!-- 弹出层样式 -->
<style>
.image-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}
.image-modal img {
    max-width: 90%;
    max-height: 90%;
    border: 2px solid white;
    border-radius: 8px;
    transform-origin: center center;
}
</style>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const images = document.querySelectorAll(".post-content img");
    const modal = document.getElementById("imageModal");
    const modalImage = document.getElementById("modalImage");
    let scale = 1;
    let initialDistance = 0;
    let isDragging = false;
    let startX = 0;
    let startY = 0;
    let offsetX = 0;
    let offsetY = 0;
    let originalWidth = 0;
    let originalHeight = 0;

    images.forEach(image => {
        image.addEventListener("click", () => {
            modal.style.display = "flex";
            modalImage.src = image.src;
            const img = new Image();
            img.src = image.src;
            img.onload = () => {
                originalWidth = img.naturalWidth;
                originalHeight = img.naturalHeight;
            };
            scale = 1;
            offsetX = 0;
            offsetY = 0;
            modalImage.style.transform = `scale(${scale}) translate(0px, 0px)`;
        });
    });

    modal.addEventListener("click", (event) => {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    });

    modalImage.addEventListener("wheel", (event) => {
        event.preventDefault();
        const zoomSpeed = 0.1;
        const maxScale = Math.max(originalWidth / modalImage.offsetWidth, originalHeight / modalImage.offsetHeight);
        const minScale = 1;
        scale += event.deltaY < 0 ? zoomSpeed : -zoomSpeed;
        scale = Math.min(Math.max(minScale, scale), maxScale);
        modalImage.style.transform = `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`;
    });

    modalImage.addEventListener("touchstart", (event) => {
        if (event.touches.length === 2) {
            const touch1 = event.touches[0];
            const touch2 = event.touches[1];
            initialDistance = Math.hypot(
                touch2.pageX - touch1.pageX,
                touch2.pageY - touch1.pageY
            );
        }
    });

    modalImage.addEventListener("touchmove", (event) => {
        if (event.touches.length === 2) {
            event.preventDefault();
            const touch1 = event.touches[0];
            const touch2 = event.touches[1];
            const currentDistance = Math.hypot(
                touch2.pageX - touch1.pageX,
                touch2.pageY - touch1.pageY
            );
            const maxScale = Math.max(originalWidth / modalImage.offsetWidth, originalHeight / modalImage.offsetHeight);
            const minScale = 1;
            const zoomSpeed = 0.005;
            scale += (currentDistance - initialDistance) * zoomSpeed;
            scale = Math.min(Math.max(minScale, scale), maxScale);
            modalImage.style.transform = `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`;
            initialDistance = currentDistance;
        }
    });

    modalImage.addEventListener("mousedown", (event) => {
        isDragging = true;
        startX = event.clientX;
        startY = event.clientY;
    });

    document.addEventListener("mousemove", (event) => {
        if (isDragging) {
            const dx = event.clientX - startX;
            const dy = event.clientY - startY;
            offsetX += dx;
            offsetY += dy;
            modalImage.style.transform = `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`;
            startX = event.clientX;
            startY = event.clientY;
        }
    });

    document.addEventListener("mouseup", () => {
        isDragging = false;
    });

    modalImage.addEventListener("touchstart", (event) => {
        if (event.touches.length === 1) {
            isDragging = true;
            startX = event.touches[0].clientX;
            startY = event.touches[0].clientY;
        }
    });

    modalImage.addEventListener("touchmove", (event) => {
        if (isDragging && event.touches.length === 1) {
            event.preventDefault();
            const dx = event.touches[0].clientX - startX;
            const dy = event.touches[0].clientY - startY;
            offsetX += dx;
            offsetY += dy;
            modalImage.style.transform = `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`;
            startX = event.touches[0].clientX;
            startY = event.touches[0].clientY;
        }
    });

    modalImage.addEventListener("touchend", () => {
        isDragging = false;
    });
});
</script>

<!-- 字数与预计阅读时间 -->
<div class="word-count" style="text-align: center; margin-top: 20px; font-size: 16px; color: #555;">
  {% assign word_count = content 
  | strip_html
  | replace: ' ', ''
  | regex_replace: '[^a-zA-Z0-9\u4e00-\u9fa5\u3040-\u309F\u30A0-\u30FF]', ''
  | size %}
  <p style="background: #f9f9f9; display: inline-block; padding: 10px 20px; border-radius: 8px; border: 1px solid #ddd;">
    全文总字数（不统计符号）：<strong style="color: #333;">{{ word_count }}</strong><br>
    预计阅读时间：<strong style="color: #333;">{{ word_count | divided_by: 700.0 | round: 1 }} min</strong>
  </p>
</div>

<!-- 标签样式 -->
<style>
  .tags {
    text-align: center;
    margin-bottom: 4px;
  }
  .tag {
    display: inline-block;
    margin: 0 6px 4px 0;
    padding: 3px 12px;
    border-radius: 4px;
    color: #fff;
    font-size: 13px;
    text-decoration: none;
    background: #888;
  }
  .tag-r18 { background: #e74c3c !important; }
  .tag-allage { background: #27ae60 !important; }
</style>
<div class="tags">
  {% for tag in page.tags %}
    {% assign color = '' %}
    {% assign tag_name = tag %}
    {% if tag contains '{#' and tag contains '}' %}
      {% assign color = tag | split: '{#' | last | split: '}' | first | prepend: '#' %}
      {% assign tag_name = tag | split: '{#' | first | strip %}
    {% endif %}
    {% if tag_name == 'R18' %}
      <a class="tag tag-r18" href="{{ site.baseurl }}/1-tags/#R18" title="R18">R18</a>
    {% elsif tag_name == '全年龄' %}
      <a class="tag tag-allage" href="{{ site.baseurl }}/1-tags/#全年龄" title="全年龄">全年龄</a>
    {% elsif color != '' %}
      <a class="tag" style="background:{{ color }};" href="{{ site.baseurl }}/1-tags/#{{ tag_name }}" title="{{ tag_name }}">{{ tag_name }}</a>
    {% else %}
      <a class="tag" style="background:#888;" href="{{ site.baseurl }}/1-tags/#{{ tag_name }}" title="{{ tag_name }}">{{ tag_name }}</a>
    {% endif %}
  {% endfor %}
</div>

<!-- 正文及行号栏 -->
<article>
  <div class="container">
    <div class="row">
      <div id="post-content-wrapper">
        <div class="line-numbers-bar" id="line-numbers-bar"></div>
        <div class="post-content" id="post-content">
          {{ content | markdownify }}
        </div>
      </div>
      <!-- 行号栏与正文栏样式 -->
      <style>
      #post-content-wrapper {
        max-width: 650px;
        margin: 40px auto;
        display: flex;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 16px rgba(0,0,0,0.04);
        border: 1px solid #eee;
        position: relative;
        padding: 0;
      }
      .line-numbers-bar {
        padding-top: 28px;
        padding-bottom: 28px;
        padding-left: 16px;
        padding-right: 6px;
        background: #fafbfc;
        border-right: 1px solid #eee;
        color: #b0b0b0;
        font-family: monospace;
        font-size: 1em;
        text-align: right;
        min-width: 2.5em;
        user-select: none;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
      }
      #post-content {
        padding: 28px 24px;
        flex: 1;
        background: transparent;
        font-size: 1.09em;
        line-height: 1.8;
      }
      </style>
      <script>
      document.addEventListener('DOMContentLoaded', function() {
        const content = document.getElementById('post-content');
        const lnb = document.getElementById('line-numbers-bar');
        if (!content || !lnb) return;
        const paragraphs = Array.from(content.children).filter(el => el.tagName === 'P');
        lnb.innerHTML = '';
        for(let i=1; i<=paragraphs.length; i++){
          const num = document.createElement('div');
          num.textContent = i;
          lnb.appendChild(num);
        }
      });
      </script>
      <!-- 行号栏样式与JS END -->

      <div class="navigation-buttons"
        style="
          width: 90%;
          max-width: 720px;
          display: flex;
          justify-content: space-between;
          flex-wrap: wrap;
          gap: 10px;
          margin: 20px auto;">
        {% if page.previous.url %}
        <a href="{{ page.previous.url | prepend: site.baseurl | replace: '//', '/' }}" 
          class="btn btn-navigation previous"
          style="
            flex: 1 1 calc(50% - 10px);
            text-align: center;
            padding: 10px;
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;">
          Previous<br>
          <span>{{ page.previous.title }}</span>
        </a>
        {% endif %}
        {% if page.next.url %}
        <a href="{{ page.next.url | prepend: site.baseurl | replace: '//', '/' }}" 
          class="btn btn-navigation next"
          style="
            flex: 1 1 calc(50% - 10px);
            text-align: center;
            padding: 10px;
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;">
          Next<br>
          <span>{{ page.next.title }}</span>
        </a>
        {% endif %}
      </div>
    </div>
  </div>
</article>

<!-- Side Catalog Container -->
{% if page.catalog %}
<div class="
    col-lg-2 col-lg-offset-0
    visible-lg-block
    sidebar-container
    catalog-container">
    <div class="side-catalog">
        <hr class="hidden-sm hidden-xs">
        <h5>
            <a class="catalog-toggle" href="#">CATALOG</a>
        </h5>
        <ul class="catalog-body"></ul>
    </div>
</div>
{% endif %}

<!-- Sidebar Container -->
<div class="
    col-lg-8 col-lg-offset-2
    col-md-10 col-md-offset-1
    sidebar-container">

    <!-- Friends Blog -->
    {% if site.friends %}
    <hr>
    <h5>Special Thanks</h5>
    <ul class="list-inline">
        {% for friend in site.friends %}
            <li><a href="{{friend.href}}">{{friend.title}}</a></li>
        {% endfor %}
    </ul>
    {% endif %}
</div>